version: '3.8'

services:
  gas-demo:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: gas-demo
    restart: unless-stopped
    ports:
      - "8001:8001"
    environment:
      - PORT=8001
      - ENVIRONMENT=${ENVIRONMENT:-production}
      - ALLOW_ORIGINS=https://gas.ezekl.com,http://gas.ezekl.com
      - FRONTEND_PATH=gas-app
      - QUICKBOOKS_CLIENT_ID=${QUICKBOOKS_CLIENT_ID}
      - QUICKBOOKS_CLIENT_SECRET=${QUICKBOOKS_CLIENT_SECRET}
      - QUICKBOOKS_REDIRECT_URI=https://gas.ezekl.com/api/v1/auth/callback
      - QUICKBOOKS_COMPANY_ID=${QUICKBOOKS_COMPANY_ID}
      - QUICKBOOKS_BASE_URL=${QUICKBOOKS_BASE_URL}
      - QUICKBOOKS_ENVIRONMENT=${QUICKBOOKS_ENVIRONMENT}
    networks:
      - gas-network
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8001/api/v1/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s

networks:
  gas-network:
    driver: bridge
