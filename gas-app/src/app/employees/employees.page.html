<ion-header>
  <ion-toolbar color="primary">
    <ion-title>Empleados</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  <div *ngIf="loading" class="ion-text-center ion-padding">
    <ion-spinner name="crescent"></ion-spinner>
    <p>Cargando empleados...</p>
  </div>

  <div *ngIf="error && !loading" class="ion-text-center ion-padding">
    <p class="ion-color-danger">{{ error }}</p>
    <ion-button (click)="loadEmployees()">Reintentar</ion-button>
  </div>

  <div *ngIf="!loading && !error">
    <div *ngIf="employees.length === 0" class="ion-text-center ion-padding">
      <ion-icon name="person" size="large" class="ion-color-medium"></ion-icon>
      <p class="ion-color-medium">No hay empleados registrados</p>
      <ion-button (click)="goToAdd()">Agregar Empleado</ion-button>
    </div>

    <ion-card *ngFor="let employee of employees">
      <ion-card-header>
        <ion-card-title>
          {{ employee.DisplayName || (employee.GivenName + ' ' + employee.FamilyName) }}
        </ion-card-title>
        <ion-card-subtitle *ngIf="employee.Title">
          {{ employee.Title }}
        </ion-card-subtitle>
      </ion-card-header>

      <ion-card-content>
        <ion-list lines="none">
          <ion-item *ngIf="employee.PrimaryEmailAddr?.Address">
            <ion-icon name="mail" slot="start"></ion-icon>
            <ion-label>{{ employee.PrimaryEmailAddr!.Address }}</ion-label>
          </ion-item>

          <ion-item *ngIf="employee.PrimaryPhone?.FreeFormNumber">
            <ion-icon name="call" slot="start"></ion-icon>
            <ion-label>{{ employee.PrimaryPhone!.FreeFormNumber }}</ion-label>
          </ion-item>

          <ion-item *ngIf="employee.PrimaryAddr?.Line1">
            <ion-icon name="location" slot="start"></ion-icon>
            <ion-label class="ion-text-wrap">
              {{ employee.PrimaryAddr!.Line1 }}
              <span *ngIf="employee.PrimaryAddr?.City">, {{ employee.PrimaryAddr!.City }}</span>
            </ion-label>
          </ion-item>

          <ion-item *ngIf="employee.EmployeeNumber">
            <ion-icon name="person" slot="start"></ion-icon>
            <ion-label>
              <strong>NÂ° Empleado:</strong> {{ employee.EmployeeNumber }}
            </ion-label>
          </ion-item>
        </ion-list>

        <div class="ion-margin-top">
          <ion-button (click)="goToEdit(employee)" fill="outline" size="small">
            <ion-icon name="create" slot="start"></ion-icon>
            Editar
          </ion-button>
          <ion-button (click)="confirmDelete(employee)" fill="outline" color="danger" size="small">
            <ion-icon name="trash" slot="start"></ion-icon>
            Eliminar
          </ion-button>
        </div>
      </ion-card-content>
    </ion-card>
  </div>

  <ion-fab vertical="bottom" horizontal="end" slot="fixed">
    <ion-fab-button (click)="goToAdd()">
      <ion-icon name="add"></ion-icon>
    </ion-fab-button>
  </ion-fab>
</ion-content>
