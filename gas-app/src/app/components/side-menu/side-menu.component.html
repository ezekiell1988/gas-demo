<ion-menu contentId="main-content" style="--width: 320px;">
  <ion-header>
    <ion-toolbar color="primary">
      <ion-title class="ion-text-center" style="padding-inline: 8px; font-size: 14px;">
        <ion-icon name="time-outline" style="vertical-align: middle; font-size: 14px;"></ion-icon>
        {{ currentTime }}
        <ion-icon name="shield-checkmark-outline" style="vertical-align: middle; margin-left: 12px; margin-right: 4px;"></ion-icon>
        QuickBooks
      </ion-title>
    </ion-toolbar>
  </ion-header>

  <ion-content>
    <!-- Loading State -->
    @if (loading) {
    <div class="ion-padding ion-text-center" style="padding-top: 60px;">
      <ion-spinner name="crescent" color="primary"></ion-spinner>
    </div>
    }

    <!-- Auth Status Section -->
    @if (!loading && authStatus) {
    <div class="ion-padding">
      <!-- Status Badge -->
      <div class="ion-text-center ion-margin-bottom">
        <ion-badge [color]="authStatus.authenticated ? 'success' : 'danger'">
          <ion-icon [name]="authStatus.authenticated ? 'checkmark-circle' : 'close-circle'" style="vertical-align: middle; margin-right: 4px;"></ion-icon>
          {{ authStatus.authenticated ? 'Conectado' : 'Desconectado' }}
        </ion-badge>
      </div>

      <!-- Company Info -->
      <ion-item lines="none" class="ion-margin-bottom" style="--background: var(--ion-color-light); --border-radius: 8px;">
        <ion-icon name="business-outline" slot="start" color="primary"></ion-icon>
        <ion-label>
          <p class="ion-text-uppercase" style="font-size: 11px; color: var(--ion-color-medium); margin: 0;">Company ID</p>
          <h3 style="font-size: 13px; font-weight: 600; margin: 4px 0 0 0;">{{ authStatus.realm_id || 'N/A' }}</h3>
        </ion-label>
      </ion-item>

      <!-- Token Status -->
      <ion-item lines="none" class="ion-margin-bottom" style="--background: var(--ion-color-light); --border-radius: 8px;">
        <ion-icon name="key-outline" slot="start" [color]="authStatus.token_valid ? 'success' : 'warning'"></ion-icon>
        <ion-label>
          <p class="ion-text-uppercase" style="font-size: 11px; color: var(--ion-color-medium); margin: 0;">Token</p>
          <h3 style="font-size: 13px; font-weight: 600; margin: 4px 0 0 0;">{{ authStatus.token_valid ? 'Válido' : 'Expirado' }}</h3>
        </ion-label>
        <ion-chip slot="end" [color]="authStatus.token_valid ? 'success' : 'danger'" style="font-size: 11px; height: 24px;">
          {{ getExpiresIn() }}
        </ion-chip>
      </ion-item>

      <!-- Info Note -->
      <ion-note class="ion-margin-bottom" color="secondary" style="display: flex; gap: 8px; padding: 12px; background: var(--ion-color-light); border-radius: 8px; border-left: 3px solid var(--ion-color-secondary); font-size: 11px; line-height: 1.4;">
        <ion-icon name="information-circle-outline" style="font-size: 16px; flex-shrink: 0;"></ion-icon>
        <span>Sesión protegida con cookies HttpOnly. Los tokens se envían automáticamente.</span>
      </ion-note>

      <!-- Refresh Token Button -->
      <ion-button
        expand="block"
        size="small"
        [disabled]="!authStatus.token_valid"
        color="success"
        (click)="refreshToken()"
        class="ion-margin-bottom">
        <ion-icon slot="start" name="sync-outline"></ion-icon>
        Renovar Token
      </ion-button>
    </div>

    <!-- Divider -->
    <div style="height: 8px; background: var(--ion-color-light);"></div>
    }

    <!-- Navigation Menu -->
    <ion-list class="ion-padding-horizontal ion-padding-top">
      <ion-menu-toggle auto-hide="false">
        <ion-item button routerLink="/home" routerDirection="root" lines="none" class="ion-margin-bottom" style="--border-radius: 8px;">
          <ion-icon slot="start" name="home-outline"></ion-icon>
          <ion-label>Inicio</ion-label>
        </ion-item>
      </ion-menu-toggle>

      <ion-menu-toggle auto-hide="false">
        <ion-item button routerLink="/employees" routerDirection="root" lines="none" class="ion-margin-bottom" style="--border-radius: 8px;">
          <ion-icon slot="start" name="people-outline"></ion-icon>
          <ion-label>Empleados</ion-label>
        </ion-item>
      </ion-menu-toggle>

      <ion-item button (click)="logout()" lines="none" color="danger" class="ion-margin-top" style="--border-radius: 8px;">
        <ion-icon slot="start" name="log-out-outline"></ion-icon>
        <ion-label>Cerrar Sesión</ion-label>
      </ion-item>
    </ion-list>
  </ion-content>
</ion-menu>
